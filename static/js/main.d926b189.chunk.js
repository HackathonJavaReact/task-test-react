(this["webpackJsonptask-test-react-2"]=this["webpackJsonptask-test-react-2"]||[]).push([[0],{23:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),r=n(17),s=n.n(r),o=(n(23),n(4)),i=(n(24),n(5)),l=n(3),u=n(6),d=n.n(u);function j(e){e&&(console.log("service/token setToken ".concat(e.substr(0,10),"...")),localStorage.setItem("token",e))}function b(){return localStorage.getItem("token")}function h(){localStorage.removeItem("token")}var m="https://api-gateway-hackathon.herokuapp.com";console.log("service/api: Base URL is: ".concat(m));var p={baseURL:m,method:"get",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}},f=d.a.create(p);f.interceptors.request.use((function(e){var t=b();return console.log("service/api: interceptor with token ".concat(t)),t&&(e.headers.Authorization="Bearer ".concat(t)),e})),f.interceptors.response.use((function(e){return console.log("res : ",e),e}),(function(e){if(401===e.response.status)throw h(),new Error("Invalid token");throw e}));var O=f,g="/api/authenticationService/";function v(){return!!b()}var x=n(0);function k(e){var t=e.spec,n=e.handleChange,a=e.handleSubmit;return Object(x.jsxs)("div",{className:"col-sm",children:[Object(x.jsx)("h3",{children:t.header}),Object(x.jsxs)("form",{children:[Object(x.jsxs)("div",{className:"form-group text-left",children:[Object(x.jsx)("label",{htmlFor:"exampleInputEmail1",children:"Nom d'utilisateur"}),Object(x.jsx)("input",{type:"username",className:"form-control",id:t.userId,"aria-describedby":"usernameHelp",placeholder:"Entrez votre nom d'utilisateur",value:t.state.username,onChange:n}),Object(x.jsx)("small",{id:"usernameHelp",className:"form-text text-muted",children:"Nom d'utilisateur (pas l'email)"})]}),Object(x.jsxs)("div",{className:"form-group text-left",children:[Object(x.jsx)("label",{htmlFor:"exampleInputPassword1",children:"Mot de passe"}),Object(x.jsx)("input",{type:"password",className:"form-control",id:t.passId,placeholder:"Entrez votre mot de passe",autoComplete:"new-password",value:t.state.password,onChange:n})]}),Object(x.jsx)("div",{className:"form-check"}),Object(x.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",onClick:a,children:t.btnValue})]})]})}var S=function(e){var t=e.setIsLoggedIn,n=Object(a.useState)({signinUsername:"",signinPassword:""}),c=Object(o.a)(n,2),r=c[0],s=c[1],u=Object(a.useState)({loginUsername:"",loginPassword:""}),d=Object(o.a)(u,2),b=d[0],h=d[1],m={header:"Sign In",userId:Object.keys(r)[0],state:r,passId:Object.keys(r)[1],btnValue:"Cr\xe9er un compte"},p={header:"Log In",userId:Object.keys(b)[0],state:b,passId:Object.keys(b)[1],btnValue:"Se connecter"};return Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)(k,{spec:m,handleChange:function(e){var t=e.target,n=t.id,a=t.value;s((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},n,a))}))},handleSubmit:function(e){e.preventDefault();var n,a,c=r.signinUsername,s=r.signinPassword;(n=c,a=s,O.post("".concat(g,"register"),{username:n,password:a}).then((function(e){var t=e.data.token;return j(t),t}))).then((function(e){alert("Success, your token is: ".concat(e)),t(v())})).catch((function(e){alert("Sorry, there was an error")})),console.log(e)}}),Object(x.jsx)(k,{spec:p,handleChange:function(e){var t=e.target,n=t.id,a=t.value;h((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},n,a))}))},handleSubmit:function(e){e.preventDefault();var n,a,c=b.loginUsername,r=b.loginPassword;(n=c,a=r,console.log("service/authentication login ".concat(n)),console.log("service/authentication login ".concat(a)),O.post("".concat(g,"authenticate"),{username:n,password:a}).then((function(e){var t=e.data.token;return j(t),t}))).then((function(e){alert("Success, your token is: ".concat(e)),t(v())})).catch((function(e){alert("Sorry, there was an error")})),console.log(e)}})]})})},w=n(8),N=n.n(w),y=n(18);var I=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],r=function(e){return e.toISOString().slice(0,19)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return new Date(new Date(e).setHours(e.getHours()+t))},u=new Date,j=s(u,1),b=Object(a.useState)({taskName:"",dateStart:r(u),dateEnd:r(j)}),h=Object(o.a)(b,2),m=h[0],p=h[1],f=function(e){var t=e.target,n=t.id,a=t.value;if(p((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(i.a)({},n,a))})),"dateStart"===n){var c=r(s(new Date(a)));p((function(e){return Object(l.a)(Object(l.a)({},e),{},{dateEnd:c})})),console.log(c)}},g=function(e){return e.replace("T"," ")};return Object(a.useEffect)((function(){(function(){var e=Object(y.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()("https://api-gateway-hackathon.herokuapp.com/api/taskService/tasks");case 2:t=e.sent,c(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("p",{children:"Home"}),Object(x.jsxs)("div",{className:"col-sm",children:[Object(x.jsx)("h3",{children:"Ajouter une t\xe2che"}),Object(x.jsxs)("form",{children:[Object(x.jsxs)("div",{className:"form-group text-left",children:[Object(x.jsx)("label",{htmlFor:"inputTache",children:"T\xe2che"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"taskName","aria-describedby":"taskNameHelp",placeholder:"Entrez une t\xe2che",value:m.taskName,onChange:f})]}),Object(x.jsxs)("div",{className:"form-group text-left",children:[Object(x.jsx)("label",{htmlFor:"inputStart",children:"Date de d\xe9but"}),Object(x.jsx)("input",{type:"datetime-local",className:"form-control",id:"dateStart",placeholder:"Entrez date de d\xe9but",min:m.dateStart,max:"2022-06-01T00:00",value:m.dateStart,onChange:f})]}),Object(x.jsxs)("div",{className:"form-group text-left",children:[Object(x.jsx)("label",{htmlFor:"inputEnd",children:"Date de fin"}),Object(x.jsx)("input",{type:"datetime-local",className:"form-control",id:"dateEnd",placeholder:"Entrez date de fin",min:m.dateEnd,max:"2022-06-01T00:00",value:m.dateEnd,onChange:f})]}),Object(x.jsx)("div",{className:"form-check"}),Object(x.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",onClick:function(e){e.preventDefault();var t,n,a,c=m.taskName,r=m.dateStart,s=m.dateEnd;""===c&&console.log("unknown"),console.log(c),console.log(r),console.log(s),(t=c,n=g(r),a=g(s),O.post("".concat("/api/taskService/","tasks"),{name:t,start:n,end:a}).then((function(e){return console.log(e.data),e.data}))).then((function(e){console.log(e)}))},children:"Ajout de la t\xe2che"})]})]}),Object(x.jsx)("ul",{children:n.length?n.map((function(e,t){return Object(x.jsxs)("li",{children:["the task : ",e.name," starts at ",e.start," and ends at ",e.end]},t)})):Object(x.jsx)("p",{children:"No tasks"})})]})};var C=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1];return n?Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)("button",{className:"btn btn-primary",onClick:function(){h(),c(!1)},children:"Log Out"}),Object(x.jsx)(I,{isLoggedIn:n})]}):Object(x.jsx)(S,{setIsLoggedIn:c})},E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};s.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(C,{})}),document.getElementById("root")),E()}},[[45,1,2]]]);
//# sourceMappingURL=main.d926b189.chunk.js.map