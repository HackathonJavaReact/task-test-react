(this["webpackJsonptask-test-react-2"]=this["webpackJsonptask-test-react-2"]||[]).push([[0],{30:function(e,t,a){},40:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(32),r=a.n(c),o=(a(40),a(4)),l=a(10),i=a(9),d=a(15),u=a.n(d);function b(e){e&&(console.log("service/token setToken ".concat(e.substr(0,10),"...")),localStorage.setItem("token",e))}function j(){return localStorage.getItem("token")}function m(){localStorage.removeItem("token")}var h={baseURL:"https://api-gateway-hackathon.herokuapp.com",method:"get",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}},O=u.a.create(h);O.interceptors.request.use((function(e){var t=j();return console.log("interceptors request with token ".concat(t)),t&&(e.headers.Authorization="Bearer ".concat(t)),e})),O.interceptors.response.use((function(e){return console.log("interceptors response : ",e),e}),(function(e){if(401===e.response.status)throw m(),new Error("Invalid token");throw e}));var p=O,f="/api/authenticationService/";function x(){return!!j()}function v(){return p.get("".concat(f,"isAuthenticated")).then((function(e){return e}))}var g=a(0);function k(e){var t=e.spec,a=e.handleChange,n=e.handleSubmit;return Object(g.jsxs)("div",{className:"col-sm",children:[Object(g.jsx)("h3",{children:t.header}),Object(g.jsxs)("form",{children:[Object(g.jsxs)("div",{className:"form-group text-left",children:[Object(g.jsx)("label",{htmlFor:"exampleInputEmail1",children:"Nom d'utilisateur"}),Object(g.jsx)("input",{type:"username",className:"form-control",id:t.userId,"aria-describedby":"usernameHelp",placeholder:"Entrez votre nom d'utilisateur",value:t.state.username,onChange:a}),Object(g.jsx)("small",{id:"usernameHelp",className:"form-text text-muted",children:"Nom d'utilisateur (pas l'email)"})]}),Object(g.jsxs)("div",{className:"form-group text-left",children:[Object(g.jsx)("label",{htmlFor:"exampleInputPassword1",children:"Mot de passe"}),Object(g.jsx)("input",{type:"password",className:"form-control",id:t.passId,placeholder:"Entrez votre mot de passe",autoComplete:"new-password",value:t.state.password,onChange:a})]}),Object(g.jsx)("div",{className:"form-check"}),Object(g.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",onClick:n,children:t.btnValue})]})]})}var N=function(e){var t=e.setIsLoggedIn,a=e.setIsAuth,s=Object(n.useState)({signinUsername:"",signinPassword:""}),c=Object(o.a)(s,2),r=c[0],d=c[1],u=Object(n.useState)({loginUsername:"",loginPassword:""}),j=Object(o.a)(u,2),m=j[0],h=j[1],O={header:"Sign In",userId:Object.keys(r)[0],state:r,passId:Object.keys(r)[1],btnValue:"Cr\xe9er un compte"},N={header:"Log In",userId:Object.keys(m)[0],state:m,passId:Object.keys(m)[1],btnValue:"Se connecter"};return Object(g.jsx)("div",{className:"container",children:Object(g.jsxs)("div",{className:"row",children:[Object(g.jsx)(k,{spec:O,handleChange:function(e){var t=e.target,a=t.id,n=t.value;d((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(l.a)({},a,n))}))},handleSubmit:function(e){e.preventDefault();var n,s,c=r.signinUsername,o=r.signinPassword;(n=c,s=o,p.post("".concat(f,"register"),{username:n,password:s}).then((function(e){var t=e.data.token;return b(t),t}))).then((function(e){alert("Success, your token is: ".concat(e)),t(x())})).catch((function(e){alert("Sorry, there was an error")})),v().then((function(e){return a(e.data)}))}}),Object(g.jsx)(k,{spec:N,handleChange:function(e){var t=e.target,a=t.id,n=t.value;h((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(l.a)({},a,n))}))},handleSubmit:function(e){e.preventDefault();var n,s,c=m.loginUsername,r=m.loginPassword;(n=c,s=r,p.post("".concat(f,"authenticate"),{username:n,password:s}).then((function(e){var t=e.data.token;return b(t),t}))).then((function(e){alert("Success, your token is: ".concat(e)),t(x())})).catch((function(e){alert("Sorry, there was an error")})),v().then((function(e){return a(e.data)}))}})]})})},y=a(19),S=a.n(y),w=a(33),I=a(35),C="/api/compose/";function E(e){return p.get("".concat("/api/taskService/","tasks/").concat(e)).then((function(e){return e.data}))}a(30);var D=function(e){var t=e.tasks,a=Object(n.useState)({}),s=Object(o.a)(a,2),c=s[0],r=s[1],l=Object(n.useRef)(null);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("ul",{className:"",children:t.length?t.map((function(e,t){return Object(g.jsxs)("li",{onClick:function(){E(e.id).then((function(e){r(e)}))},"data-bs-toggle":"modal","data-bs-target":"#exampleModal",children:["the task : ",Object(g.jsx)("b",{children:e.name})," starts at ",Object(g.jsx)("b",{children:e.start})," and ends at"," ",Object(g.jsx)("b",{children:e.end})]},t)})):Object(g.jsx)("p",{children:"No tasks"})}),Object(g.jsx)("div",{className:"modal fade",ref:l,id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(g.jsx)("div",{className:"modal-dialog",children:Object(g.jsxs)("div",{className:"modal-content",children:[Object(g.jsxs)("div",{className:"modal-header",children:[Object(g.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:c.name}),Object(g.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(g.jsxs)("div",{className:"modal-body",children:[Object(g.jsxs)("p",{children:["Date d\xe9but : ",c.start]}),Object(g.jsxs)("p",{children:["Date fin : ",c.end]})]}),Object(g.jsx)("div",{className:"modal-footer",children:Object(g.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Fermer"})})]})})})]})};var F=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)({}),r=Object(o.a)(c,2),l=r[0],i=r[1],d=Object(n.useRef)(null);return Object(n.useEffect)((function(){p.get("".concat(C,"user/tasks")).then((function(e){return e.data})).then((function(e){s(e)}))}),[]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("ul",{className:"",children:a.length?a.map((function(e,t){return Object(g.jsxs)("li",{onClick:function(){E(e.id).then((function(e){i(e)}))},"data-bs-toggle":"modal","data-bs-target":"#exampleModal",children:["the task : ",Object(g.jsx)("b",{children:e.name})," starts at ",Object(g.jsx)("b",{children:e.start})," and ends at"," ",Object(g.jsx)("b",{children:e.end})]},t)})):Object(g.jsx)("p",{children:"No tasks"})}),Object(g.jsx)("div",{className:"modal fade",ref:d,id:"exampleModal",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(g.jsx)("div",{className:"modal-dialog",children:Object(g.jsxs)("div",{className:"modal-content",children:[Object(g.jsxs)("div",{className:"modal-header",children:[Object(g.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:l.name}),Object(g.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(g.jsxs)("div",{className:"modal-body",children:[Object(g.jsxs)("p",{children:["Date d\xe9but : ",l.start]}),Object(g.jsxs)("p",{children:["Date fin : ",l.end]})]}),Object(g.jsx)("div",{className:"modal-footer",children:Object(g.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Fermer"})})]})})})]})},L=a(16),T=a(2);var M=function(){var e=Object(n.useState)([]),t=Object(o.a)(e,2),a=t[0],s=t[1],c=function(e){return e.toISOString().slice(0,19)},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return new Date(new Date(e).setHours(e.getHours()+t))},d=new Date,b=r(d,1),j=Object(n.useState)({taskName:"",dateStart:c(d),dateEnd:c(b)}),m=Object(o.a)(j,2),h=m[0],O=m[1],f=function(e){var t=e.target,a=t.id,n=t.value;if(O((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(l.a)({},a,n))})),"dateStart"===a){var s=c(r(new Date(n)));O((function(e){return Object(i.a)(Object(i.a)({},e),{},{dateEnd:s})}))}},x=function(e){return e.replace("T"," ")};return Object(n.useEffect)((function(){(function(){var e=Object(w.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u()("https://api-gateway-hackathon.herokuapp.com/api/taskService/tasks");case 2:t=e.sent,s(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("p",{children:"Home"}),Object(g.jsxs)("div",{className:"col-sm mb-3 pb-3 border-bottom border-2",children:[Object(g.jsx)("h3",{children:"Ajouter une t\xe2che"}),Object(g.jsxs)("form",{children:[Object(g.jsxs)("div",{className:"form-group text-left",children:[Object(g.jsx)("label",{htmlFor:"inputTache",children:"T\xe2che"}),Object(g.jsx)("input",{type:"text",className:"form-control",id:"taskName","aria-describedby":"taskNameHelp",placeholder:"Entrez une t\xe2che",value:h.taskName,onChange:f})]}),Object(g.jsxs)("div",{className:"form-group text-left",children:[Object(g.jsx)("label",{htmlFor:"inputStart",children:"Date de d\xe9but"}),Object(g.jsx)("input",{type:"datetime-local",className:"form-control",id:"dateStart",placeholder:"Entrez date de d\xe9but",min:h.dateStart,max:"2022-06-01T00:00",value:h.dateStart,onChange:f})]}),Object(g.jsxs)("div",{className:"form-group text-left",children:[Object(g.jsx)("label",{htmlFor:"inputEnd",children:"Date de fin"}),Object(g.jsx)("input",{type:"datetime-local",className:"form-control",id:"dateEnd",placeholder:"Entrez date de fin",min:h.dateEnd,max:"2022-06-01T00:00",value:h.dateEnd,onChange:f})]}),Object(g.jsx)("div",{className:"form-check"}),Object(g.jsx)("button",{type:"submit",className:"btn btn-primary btn-block",onClick:function(e){e.preventDefault();var t,a,n,c=h.taskName,r=h.dateStart,o=h.dateEnd;(t=c,a=x(r),n=x(o),p.post("".concat(C,"task"),{name:t,start:a,end:n}).then((function(e){return e.data}),(function(e){500===e.response.status&&console.log(e)}))).then((function(e){s((function(t){return[].concat(Object(I.a)(t),[e])}))}))},children:"Ajout de la t\xe2che"})]})]}),Object(g.jsxs)(L.a,{children:[Object(g.jsx)(L.b,{to:"/",children:Object(g.jsx)("button",{className:"btn btn-primary",children:"Toutes les T\xe2ches"})}),Object(g.jsx)(L.b,{to:"/mytasks",children:Object(g.jsx)("button",{className:"btn btn-primary",children:"Mes T\xe2ches"})}),Object(g.jsxs)(T.c,{children:[Object(g.jsx)(T.a,{exact:!0,path:"/",children:Object(g.jsx)(D,{tasks:a})}),Object(g.jsx)(T.a,{path:"/mytasks",children:Object(g.jsx)(F,{})})]})]})]})};var A=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(!1),r=Object(o.a)(c,2),l=r[0],i=r[1];return Object(n.useEffect)((function(){v().then((function(e){return i(e.data)}))})),l?Object(g.jsxs)("div",{className:"container-fluid pt-2",children:[Object(g.jsx)("button",{className:"btn btn-primary mr-2",onClick:function(){m(),s(!1),p.post("/logout"),v().then((function(e){return i(e.data)}))},children:"Log Out"}),Object(g.jsx)(M,{isLoggedIn:a})]}):Object(g.jsx)(N,{setIsLoggedIn:s,setIsAuth:i})},P=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,67)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))};r.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(A,{})}),document.getElementById("root")),P()}},[[66,1,2]]]);
//# sourceMappingURL=main.d874a46a.chunk.js.map